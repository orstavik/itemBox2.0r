<link rel="import" href="selection-box.html">
<link rel="import" href="shape-box.html">

<dom-module id="ui-plain">
  <template>
    <style>
      :host {
        height: 100%;
      }
    </style>

    <selection-box id="selection"
                   shapes="[[shapesRegistry]]"></selection-box>
    <slot></slot>
    <shape-box id="shapeBox"
               shapes="[[selectedRegistry]]"></shape-box>

  </template>

  <script>

    class UiPlain extends Polymer.Element {
      static get is() {
        return "ui-plain";
      }

      static get properties() {
        return {
          shapesRegistry: {
            type: Object,
            value: function () {
              return {}
            }
          },
          selectedRegistry: {
            type: Object,
            value: function () {
              return {}
            }
          }
        }
      }

      constructor() {
        super();
        this.addEventListener("shape-location", this._shapeLocation.bind(this));
      }

      //todo here we have a State object that is an array of the selected id's
      //todo a) this selected state might be kept with the rest of the data of the element, such as widdth and height
      //todo b) but it might also be kept in a separate list of just the id's
      //todo I think plan a) is best..
      _shapeLocation(e) {
        this.set("shapesRegistry." + e.detail.id, e.detail);
        if (e.detail.selected) {
          this.selectedRegistry[e.detail.id] = e.detail;
        } else {
          delete this.selectedRegistry[e.detail.id];
        }
        this.set("selectedRegistry", Object.assign({}, this.selectedRegistry));
      }
    }
    customElements.define(UiPlain.is, UiPlain);
  </script>
</dom-module>