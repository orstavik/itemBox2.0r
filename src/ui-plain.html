<link rel="import" href="selection-box.html">
<link rel="import" href="shape-box.html">

<dom-module id="ui-plain">
  <template>
    <style>
      :host {
        height: 100%;
      }
    </style>

    <selection-box id="selection"
                   shapes="[[shapes]]"></selection-box>
                   <!--shapes="[[shapesRegistry]]"></selection-box>-->
    <slot></slot>
    <shape-box id="shapeBox"
               shapes="[[selectedRegistry]]"></shape-box>

  </template>

  <script>

    class UiPlain extends Polymer.Element {
      static get is() {
        return "ui-plain";
      }

      static get properties() {
        return {
          shapes: Object,
          shapesRegistry: {
            type: Object,
            value: function () {
              return {}
            }
          },
          selectedRegistry: {
            type: Object,
            computed: "_makeSelectedRegistry(shapes)"
          }
        }
      }

      constructor() {
        super();
//        this.addEventListener("shape-location", this._shapeLocation.bind(this));
      }

      _makeSelectedRegistry(shapes){
        const res ={};
        for (let key in shapes) {
          if (shapes[key].selected)
            res[key] = shapes[key];
        }
        return res;
      }

//      _shapeLocation(e) {
//        this.set("shapesRegistry." + e.detail.id, e.detail);
//        if (e.detail.selected) {
//          this.selectedRegistry[e.detail.id] = e.detail;
//        } else {
//          delete this.selectedRegistry[e.detail.id];
//        }
//        this.set("selectedRegistry", Object.assign({}, this.selectedRegistry));
//      }
    }
    customElements.define(UiPlain.is, UiPlain);
  </script>
</dom-module>